"use strict";var w=(r,e,s)=>{if(!e.has(r))throw TypeError("Cannot "+s)};var u=(r,e,s)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,s)};var l=(r,e,s)=>(w(r,e,"access private method"),s);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var n,b,i,f;const a=class{constructor(e,s,t){this.pkgCmd=s,this.pmCmd=void 0,this.targetArgs=(t==null?void 0:t.args)??[];const c=(t==null?void 0:t.format)??"short",m=(t==null?void 0:t.download)??"prefer-always";this.cmd=e.name,this.structIsReady=new Promise(h=>{var g;l(g=a,n,b).call(g,e,s,c,m).then(({cmd:y,pmCmd:C})=>{var x;this.cmd=y,this.pmCmd=C,["yarn","pnpm"].includes(e.name)&&C==="exec"&&(this.pkgCmd=l(x=a,i,f).call(x,this.pkgCmd)),e.name==="npm"&&this.pmCmd==="exec"&&(this.argsNeedDoubleDashes=!0),h()})}),this.argsNeedDoubleDashes=e.metadata.isYarnClassic}get cmdArgs(){return[...this.pmCmd?[this.pmCmd]:[],this.pkgCmd,...this.targetArgs.length&&this.argsNeedDoubleDashes?["--"]:[],...this.targetArgs]}toString(){return`${this.cmd}${this.pmCmd?` ${this.pmCmd}`:""} ${this.pkgCmd}${this.targetArgs.length?`${this.argsNeedDoubleDashes?" --":""} ${this.targetArgs.join(" ")}`:""}`}};let d=a;n=new WeakSet,b=async function(e,s,t,c){switch(e.name){case"bun":return t==="short"?{cmd:"bunx"}:{cmd:"bun",pmCmd:"x"};case"npm":return t==="short"?{cmd:"npx"}:{cmd:"npm",pmCmd:"exec"};case"yarn":if(e.metadata.isYarnClassic)return{cmd:"yarn",pmCmd:"exec"};break}const m={cmd:e.name};switch(c){case"prefer-always":m.pmCmd="dlx";break;case"prefer-never":m.pmCmd="exec";break;case"prefer-if-needed":{const h=await e.getPackageInfo(s);m.pmCmd=h?"exec":"dlx";break}}return m},i=new WeakSet,f=function(e){const s=e.match(/^@[^/]+\/(.*)/);return(s==null?void 0:s[1])??e},u(d,n),u(d,i);function o(r){const e=async(t,c)=>{if(!t)return null;const m=new d(r,t,c);return await m.structIsReady,m};return{getRunExec:async(...t)=>{var c;return((c=await e(...t))==null?void 0:c.toString())??null},getRunExecStruct:e}}exports.getRunExecFunctions=o;
//# sourceMappingURL=getRunExec.cjs.map
