{"version":3,"file":"npm.cjs","sources":["../../src/package/npm.ts"],"sourcesContent":["import { shellac } from '../utils';\nimport type { GetPackageInfo } from './index';\n\ntype NpmListOutputJsonDependency = {\n\tversion: string;\n\tresolved: string;\n};\n\ntype NpmListOutputJson = {\n\tversion: string;\n\tname: string;\n\tdependencies?: Record<string, NpmListOutputJsonDependency>;\n\tdevDependencies?: Record<string, NpmListOutputJsonDependency>;\n};\n\nexport function getNpmGetPackageInfoFunction() {\n\treturn async (...[name]: Parameters<GetPackageInfo>): ReturnType<GetPackageInfo> => {\n\t\ttry {\n\t\t\tconst listOutput = (await shellac`$ npm list --depth=0 --json`).stdout;\n\n\t\t\tconst outputJson = JSON.parse(listOutput);\n\n\t\t\tconst info: NpmListOutputJson = outputJson;\n\t\t\tconst packageInfo = info.dependencies?.[name] ?? info.devDependencies?.[name];\n\n\t\t\tif (!packageInfo) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn { name, version: packageInfo.version };\n\t\t} catch {\n\t\t\tthrow new Error(`An error occurred while gathering the package info of \"${name}\"`);\n\t\t}\n\t};\n}\n"],"names":["getNpmGetPackageInfoFunction","name","listOutput","shellac","info","packageInfo","_a","_b"],"mappings":"kPAeO,SAASA,GAA+B,CACvC,MAAA,UAAU,CAACC,CAAI,IAA8D,SAC/E,GAAA,CACG,MAAAC,GAAc,MAAMC,EAAsC,sCAAA,OAI1DC,EAFa,KAAK,MAAMF,CAAU,EAGlCG,IAAcC,EAAAF,EAAK,eAAL,YAAAE,EAAoBL,OAASM,EAAAH,EAAK,kBAAL,YAAAG,EAAuBN,IAExE,OAAKI,EAIE,CAAE,KAAAJ,EAAM,QAASI,EAAY,OAAQ,EAHpC,IAGoC,MAC3C,CACK,MAAA,IAAI,MAAM,0DAA0DJ,IAAO,CAClF,CAAA,CAEF"}