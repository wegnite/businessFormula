{"version":3,"file":"npm.js","sources":["../../src/package/npm.ts"],"sourcesContent":["import { shellac } from '../utils';\nimport type { GetPackageInfo } from './index';\n\ntype NpmListOutputJsonDependency = {\n\tversion: string;\n\tresolved: string;\n};\n\ntype NpmListOutputJson = {\n\tversion: string;\n\tname: string;\n\tdependencies?: Record<string, NpmListOutputJsonDependency>;\n\tdevDependencies?: Record<string, NpmListOutputJsonDependency>;\n};\n\nexport function getNpmGetPackageInfoFunction() {\n\treturn async (...[name]: Parameters<GetPackageInfo>): ReturnType<GetPackageInfo> => {\n\t\ttry {\n\t\t\tconst listOutput = (await shellac`$ npm list --depth=0 --json`).stdout;\n\n\t\t\tconst outputJson = JSON.parse(listOutput);\n\n\t\t\tconst info: NpmListOutputJson = outputJson;\n\t\t\tconst packageInfo = info.dependencies?.[name] ?? info.devDependencies?.[name];\n\n\t\t\tif (!packageInfo) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn { name, version: packageInfo.version };\n\t\t} catch {\n\t\t\tthrow new Error(`An error occurred while gathering the package info of \"${name}\"`);\n\t\t}\n\t};\n}\n"],"names":["getNpmGetPackageInfoFunction","name","listOutput","shellac","info","packageInfo","_a","_b"],"mappings":";;;;;;AAeO,SAASA,IAA+B;AACvC,SAAA,UAAU,CAACC,CAAI,MAA8D;;AAC/E,QAAA;AACG,YAAAC,KAAc,MAAMC,gCAAsC,QAI1DC,IAFa,KAAK,MAAMF,CAAU,GAGlCG,MAAcC,IAAAF,EAAK,iBAAL,gBAAAE,EAAoBL,SAASM,IAAAH,EAAK,oBAAL,gBAAAG,EAAuBN;AAExE,aAAKI,IAIE,EAAE,MAAAJ,GAAM,SAASI,EAAY,QAAQ,IAHpC;AAAA,IAGoC,QAC3C;AACK,YAAA,IAAI,MAAM,0DAA0DJ,IAAO;AAAA,IAClF;AAAA,EAAA;AAEF;"}